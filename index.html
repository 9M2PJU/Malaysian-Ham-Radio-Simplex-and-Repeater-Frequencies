<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Malaysian Ham Radio Frequencies</title>
  <meta name="description" content="Comprehensive Malaysian ham radio frequencies including repeaters, simplex channels, and PMR – ready for CHIRP import.">
  <meta name="keywords" content="radio amatur, frekuensi, walkie talkie, APRS, Malaysia, frekuensi radio, Malaysia, Malaysian ham radio, simplex, repeater, PMR, CHIRP, amateur radio, 9M2PJU, radio frequency Malaysia">
  <meta name="author" content="9M2PJU">
  <meta property="og:title" content="Malaysian Ham Radio Frequencies" />
  <meta property="og:description" content="Complete list of simplex, repeater, and PMR channels in Malaysia for licensed operators." />
  <meta property="og:url" content="https://frequency.hamradio.my/" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://pass.hamradio.my/favicon.ico" />

  <link rel="icon" href="https://pass.hamradio.my/favicon.ico" type="image/x-icon"/>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @media print {
      header, footer, input, button { display: none !important; }
      table { page-break-after: always; }
      body { background: white !important; color: black !important; }
    }
    .clickable {
      color: #3b82f6;
      cursor: pointer;
      text-decoration: underline;
    }
    #photo { display: none; margin-top: 1rem; }
  </style>
</head>
<body class="bg-white text-gray-900 dark:text-gray-100 dark:bg-gray-900">

  <header class="bg-gray-100 dark:bg-gray-800 p-4 shadow print:hidden">
    <div class="max-w-4xl mx-auto">
      <h1 class="text-2xl font-bold">🇲🇾 Malaysian Ham Radio Frequencies</h1>
      <div class="mt-3">
        <input id="search" type="text" placeholder="🔍 Search..." class="w-full px-4 py-2 border rounded dark:bg-gray-700 dark:border-gray-600"/>
      </div>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-4">
    <!-- 📡 Static Project Description -->
    <section class="mb-6">
      <h2 class="text-xl font-bold mb-2">📡 Malaysian Ham Radio Frequencies Collection</h2>
      <p class="text-gray-700 dark:text-gray-300">
        A comprehensive frequency database for Malaysian amateur radio operators and PMR users.
      </p>
      <p class="mt-4 text-gray-600 dark:text-gray-400">
        Welcome to the most comprehensive collection of Malaysian amateur radio frequencies! This repository contains meticulously curated CSV files with simplex frequencies, repeater configurations, and PMR channels specifically designed for radio operators in Malaysia.
      </p>
      <ul class="list-disc ml-6 mt-3 text-sm text-gray-600 dark:text-gray-400">
        <li>🔄 <strong>CHIRP Ready</strong> - Direct import compatibility</li>
        <li>📊 <strong>Comprehensive Coverage</strong> - Amateur radio + PMR frequencies</li>
        <li>🇲🇾 <strong>Malaysia Focused</strong> - Locally relevant frequency allocations</li>
        <li>🎨 <strong>Easy Integration</strong> - One-click radio programming</li>
        <li>🔧 <strong>Regularly Updated</strong> - Community-driven maintenance</li>
      </ul>
      <p class="mt-4">
        🌐 View or contribute on GitHub:
        <a href="https://github.com/9M2PJU/Malaysian-Ham-Radio-Simplex-and-Repeater-Frequencies"
           class="underline text-blue-600 dark:text-blue-400" target="_blank">
          github.com/9M2PJU/Malaysian-Ham-Radio-Simplex-and-Repeater-Frequencies
        </a>
      </p>
    </section>

    <!-- 📊 Dynamic Frequency Tables -->
    <div id="output">
      <p class="text-center text-gray-500 dark:text-gray-400">Loading data...</p>
    </div>
  </main>

  <footer class="text-center text-sm text-gray-600 dark:text-gray-400 mt-8 mb-4 print:hidden">
    <p>Made for 🇲🇾 by <a href="https://hamradio.my" class="underline">9M2PJU</a></p>
    <p>If you want to support this community project, click <span class="clickable" onclick="togglePhoto()">here</span></p>
    <img id="photo" src="https://drive.google.com/thumbnail?id=1lf1zgIN1Kx5cduZM79n3boGDJQ68uSJ_&sz=w1000" alt="Support Image"/>
  </footer>

  <script>
    function togglePhoto() {
      const img = document.getElementById("photo");
      img.style.display = img.style.display === "none" ? "block" : "none";
    }

    const searchInput = document.getElementById('search');
    const output = document.getElementById('output');
    let allRows = [];

    function bandBadge(freq) {
      if (freq >= 446 && freq <= 446.2)
        return `<span class="px-2 py-0.5 text-xs bg-green-200 text-green-800 rounded">PMR</span>`;
      if (freq < 300)
        return `<span class="px-2 py-0.5 text-xs bg-blue-200 text-blue-800 rounded">VHF</span>`;
      return `<span class="px-2 py-0.5 text-xs bg-purple-200 text-purple-800 rounded">UHF</span>`;
    }

    function createSection(rows, title) {
      const sec = document.createElement('section');
      sec.className = "bg-gray-50 dark:bg-gray-800 rounded-md mb-6 p-4 shadow";

      const header = document.createElement('div');
      header.className = "flex justify-between items-center cursor-pointer";

      const h3 = document.createElement('h3');
      h3.textContent = title;
      h3.className = "text-lg font-semibold";

      const btn = document.createElement('button');
      btn.textContent = '–';
      btn.className = 'px-2';

      const table = document.createElement('table');
      table.className = "w-full text-sm mt-2";
      table.innerHTML = `
        <thead class="border-b">
          <tr class="text-left">
            <th>Name</th><th>Freq</th><th>Band</th><th>Offset</th><th>Tone</th><th>Mode</th><th class="hidden sm:table-cell">Comment</th>
          </tr>
        </thead>
        <tbody>${rows.map(r => `
          <tr class="border-t hover:bg-gray-100 dark:hover:bg-gray-700">
            <td>${r.Name}</td>
            <td>${r.Frequency}</td>
            <td>${bandBadge(parseFloat(r.Frequency) || 0)}</td>
            <td>${r.Offset}</td>
            <td>${r.Tone}</td>
            <td>${r.Mode}</td>
            <td class="hidden sm:table-cell">${r.Comment}</td>
          </tr>`).join('')}</tbody>`;

      btn.onclick = () => {
        table.classList.toggle('hidden');
        btn.textContent = table.classList.contains('hidden') ? '+' : '–';
      };

      header.append(h3, btn);
      sec.append(header, table);
      return sec;
    }

    function render(rows) {
      output.innerHTML = '';
      const groups = { Simplex: [], Repeaters: [], PMR: [] };

      rows.forEach(r => {
        const f = parseFloat(r.Frequency) || 0;
        const o = parseFloat(r.Offset) || 0;
        const isPMR = f >= 446 && f <= 446.2;
        const category = isPMR ? 'PMR' : (o === 0 ? 'Simplex' : 'Repeaters');
        groups[category].push(r);
      });

      ['Simplex', 'Repeaters', 'PMR'].forEach(cat => {
        if (groups[cat].length) {
          const section = createSection(groups[cat], cat + (cat === 'PMR' ? ' (446 MHz)' : ''));
          output.appendChild(section);
        }
      });

      if (rows.length === 0)
        output.innerHTML = '<p class="text-center">No entries found.</p>';
    }

    searchInput.oninput = () => {
      const q = searchInput.value.toLowerCase();
      render(allRows.filter(r => Object.values(r).join(' ').toLowerCase().includes(q)));
    };

    Papa.parse('9M2PJU.csv', {
      download: true,
      header: true,
      complete: r => {
        allRows = r.data.filter(x => x.Name || x.Frequency);
        render(allRows);
      }
    });
  </script>
</body>
</html>
